<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ECS521 Project: Escape Game</title>
<style>
body{
	background-color:black;
	margin: 0;
}
#game{
	display:block;
	width :1200px;
	margin-left: auto;
	margin-right: auto;
}
#canvasOne{
	margin:0;
}
#canvasTwo{
	background-color:white;
	margin:0;
	position: relative;
	top:-350px;
}
</style>
</head>
<body>
<div id="game">
	<canvas id = "canvasTwo" width = "200" height = "350"></canvas
    ><canvas id = "canvasOne" width = "1000" height = "700"></canvas>
</div>
<script type="text/javascript" src="Animation.js"></script>
<script type="text/javascript">
    /**
     * Screen 0: start screen
     * 1: basic living room view
     * 2: up close puzzle view
     * 3: up close portrait painting view
     * 4: up close desk drawer view
     * 5: up close xylophone view
     * 6: hallway view
     * 7: up close closed bedroom door
     * 8: up close open bedroom door
     * 9: winning screen
     * 10: death by monster screen
     * 11: death by timer screen
     */
    var currentScreen = 0;
    var timer = 0;
	var totalResources = 1;
	var totalResources = 9;
	var numResourcesLoaded = 0;
	var finishedLoading = false;
	var images = {};
	var hasBedroomKey = false; // until they get it from the portrait
    var hasWeapon = false; // until they get the fire poker

	function loadImage(name) {
		images[name] = new Image();
		images[name].onload = function() {
			resourceLoaded();
		}
		images[name].src = "./images/" + name + ".png";
	}
	function resourceLoaded() {

		numResourcesLoaded += 1;
		if(numResourcesLoaded === totalResources) {
			finishedLoading = true;
		}
	}
    function init() {
        var canvas = document.getElementById("canvasOne");
        var context = canvas.getContext("2d");
		
		context.fillStyle="white";
		context.font = "100px Georgia";
		context.fillText("loading...", 40, 140);
		
		loadImage("SCREEN1");
		loadImage("SCREENGAMEOVER");
		loadImage("SCREENMONSTER");
		loadImage("SCREENWIN");
		loadImage("opendoor");
		loadImage("monster");
		loadImage("livingroom");
		loadImage("hallway");
		loadImage("closeddoor");
    }

    function startGame() {
        // TODO: DRAW TOOLBAR AND TIMER AND BEGIN TIMER COUNTDOWN
		
		
    }

    function continueGame(canvas,context) {
        if (currentScreen == 0) {            
			if(finishedLoading){
				context.drawImage(images["SCREEN1"], 0, 0, canvas.width, canvas.height);
			}
        } else if (currentScreen == 1) {

        }
    }
	

    function drawHallway(canvas,context) {
            context.drawImage(images["hallway"], 0, 0,canvas.width, canvas.height);
    }

    // if they click on the door AFTER they are inside the hallway
    function drawUpCloseBedroomDoor(canvas,context) {
		context.drawImage(images["deathdoor"], 0, 0, canvas.width, canvas.height);
    }

    // if they click on the bedroom door AFTER they are at the close up view (not if they are just inside the hallway still)
    function attemptUnlockUpCloseBedroomDoor(canvas,context) {
        if (hasBedroomKey && hasWeapon) {
                context.drawImage(images["opendoor"], 0, 0, canvas.width, canvas.height);

            // then play the video of beating the monster and getting the key
        } else if (hasBedroomKey && ! hasWeapon) {
            context.drawImage(images["monster"], 0, 0, canvas.width, canvas.height);

            // then play the video of getting killed by the monster

            // then take user to end screen
			context.drawImage(images["SCREENMONSTER"], 0, 0, canvas.width, canvas.height);
            

        } else {
            // play some kind of "locked door" sound, display text of "door is locked"
        }
    }

    // return to living room
    function drawLivingRoom(){
        context.drawImage(images["livingroom"], 0, 0, canvas.width, canvas.height);
    }

    window.onload = function() {
		var anim = new Animation("canvasOne");
		var anim2 = new Animation("canvasTwo");
		var canvas = anim.getCanvas();
		var canvas2 = anim2.getCanvas();
		var context = anim.getContext();
		var context2 = anim2.getContext();
		init();
		
		anim.setStage(function() {
			
			this.clear();
			continueGame(canvas,context);
			
		});
		anim.start();
	}
</script>

</body>
</html>
