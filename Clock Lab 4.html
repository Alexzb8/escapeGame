<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <title>140416633 Clock Assignment</title>
<script type="text/javascript">
	var Animation = function(canvasId){
	this.canvas = document.getElementById(canvasId);
	this.context = this.canvas.getContext("2d");
	this.t = 0;
	this.timeInterval = 0;
	this.startTime = 0;
	this.lastTime = 0;
	this.frame = 0;
	this.animating = false;
	// provided by Paul Irish
	window.requestAnimFrame = (function(callback){
		return window.requestAnimationFrame ||
		window.webkitRequestAnimationFrame ||
		window.mozRequestAnimationFrame ||
		window.oRequestAnimationFrame ||
		window.msRequestAnimationFrame ||
		function(callback){
			window.setTimeout(callback, 1000 / 60);
		};
	})();
};
Animation.prototype.getContext = function(){
	return this.context;
};
Animation.prototype.getCanvas = function(){
	return this.canvas;
};
Animation.prototype.clear = function(){
	this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
};
Animation.prototype.setStage = function(func){
	this.stage = func;
};
Animation.prototype.isAnimating = function(){
	return this.animating;
};
Animation.prototype.getFrame = function(){
	return this.frame;
};
Animation.prototype.start = function(){
	this.animating = true;
	var date = new Date();
	this.startTime = date.getTime();
	this.lastTime = this.startTime;
	if (this.stage !== undefined) {
		this.stage();
	}
	this.animationLoop();
};
Animation.prototype.stop = function(){
	this.animating = false;
};
Animation.prototype.getTimeInterval = function(){
	return this.timeInterval;
};
Animation.prototype.getTime = function(){
	return this.t;
};
Animation.prototype.getFps = function(){
	return this.timeInterval > 0 ? 1000 / this.timeInterval : 0;
};
Animation.prototype.animationLoop = function(){
	var that = this;
	this.frame++;
	var date = new Date();
	var thisTime = date.getTime();
	this.timeInterval = thisTime - this.lastTime;
	this.t += this.timeInterval;
	this.lastTime = thisTime;
	if (this.stage !== undefined) {
		this.stage();
	}
	if (this.animating) {
		requestAnimFrame(function(){
				that.animationLoop();
		});
	}
};


</script>
</head>
<body>
<div style="text-align:center;font-family: 'Raleway', sans-serif;font-size: 20px;
  color: #fff;
  -webkit-text-stroke: 2px black;"><h1>Jorge Zuniga - 140416633</h1></div>
 <div style="width:600px;
			margin-left:auto;
			margin-right:auto;
			-webkit-text-stroke-width: 3px;
   -webkit-text-stroke-color: white;">
 <canvas id="canvasOne" width="600" height="300"></canvas>
 </div>
 <script type="text/javascript">
function drawclock(x,y,radius,context){
 	 
 	 //draw circle
	context.beginPath();
	context.arc(x, y, radius, 0, 2 * Math.PI, false);
	context.lineWidth = 3;
	context.strokeStyle="#0069E8";
	context.stroke();

	
	//draw numbers
	context.font = "28px Calibri";
	context.fillStyle = "#0069E8";
	var angledif = (2*Math.PI)/12;
	var numradius = radius-20;
	var xnum =0; 
	var ynum =0; 
	var yoffset = 10;
	var xoffset = 10;
	var angle= (Math.PI/2)-.05; 
	
	for(i=12;i>=1;i--){
		ynum = y - (Math.sin(angle)*numradius)+ yoffset;
		xnum = x - (Math.cos(angle)*numradius)- xoffset;
		context.fillText(i,xnum,ynum);
		angle= angle - angledif; 
	}
 
}

function goX(xref,x,y,ang){
	var sin = Math.sin(ang);
	var cos = Math.cos(ang);	
	var x = xref+(x*cos)+(y*sin);
	return x;
}
function goY(yref,x,y,ang){
	var sin = Math.sin(ang);
	var cos = Math.cos(ang);
	var y = yref+(y*cos)+((-1*x)*sin);
	return y;
}

function drawseconds(x,y,ang,context){
	
	
	context.save();
	context.beginPath();
	context.moveTo( goX(x,-20,-2,ang) , goY(y,-20,-2,ang) );
	context.lineTo( goX(x,90,0,ang) , goY(y,90,0,ang) );
	context.lineTo( goX(x,90,0,ang) , goY(y,90,0,ang) );
	context.lineTo( goX(x,-20,2,ang) , goY(y,-20,2,ang) );
	context.closePath();
	context.fillStyle="red";
	context.fill();
	context.restore();
}

function drawminutes(x,y,ang,context){
	
	
	context.save();
	context.beginPath();
	context.moveTo( goX(x,-20,-3,ang) , goY(y,-20,-3,ang) );
	context.lineTo( goX(x,80,-1,ang) , goY(y,80,-1,ang) );
	context.lineTo( goX(x,80,1,ang) , goY(y,80,1,ang) );
	context.lineTo( goX(x,-20,3,ang) , goY(y,-20,3,ang) );
	context.closePath();
	context.fillStyle="#0069E8";
	context.fill();
	context.restore();
}

function drawhours(x,y,ang,context){	
	
	context.save();
	context.beginPath();
	context.moveTo( goX(x,-20,-3,ang) , goY(y,-20,-3,ang) );
	context.lineTo( goX(x,60,-1,ang) , goY(y,60,-1,ang) );
	context.lineTo( goX(x,60,1,ang) , goY(y,60,1,ang) );
	context.lineTo( goX(x,-20,3,ang) , goY(y,-20,3,ang) );
	context.closePath();
	context.fillStyle="#0069E8";
	context.fill();
	context.restore();
}
 
 window.onload = function() {
	var anim = new Animation("canvasOne");
	var canvas = anim.getCanvas();
	var context = anim.getContext();

	//center coordinates
	var x=canvas.width/2;
	var y=canvas.height/2;
	
	//radius of clock
	var radius=canvas.height/3;

	

	anim.setStage(function() {
		var d = new Date();
		var h = d.getHours();
		if(h>12){h=h-12;}
		var m = d.getMinutes();
		var s =  d.getSeconds();
		var ms = d.getMilliseconds();
		
		console.log(h+":"+m+":"+s);
		
		//add decimals for more accurate hands
		s = s+(ms/1000);
		m = m+(s/60);
		h = h+(m/60);
		
		
		//get angles
		var angleseconds=(s*( (Math.PI/2+(Math.PI*3/2))/(-60))) +(Math.PI/2);
		var angleminutes=(m*( (Math.PI/2+(Math.PI*3/2))/(-60))) +(Math.PI/2);
		var anglehours=(h*( (Math.PI/2+(Math.PI*3/2))/(-12))) +(Math.PI/2);
		
		
		
		//DRAW
		this.clear();
		
		drawclock(x,y,radius,context);

		drawhours(x,y,anglehours,context);

		drawminutes(x,y,angleminutes,context);

		drawseconds(x,y,angleseconds,context);
		
	});
	anim.start();
};
</script>
</body>
</html>
